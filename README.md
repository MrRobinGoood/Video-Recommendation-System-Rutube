# Video-Recommendation-System-Rutube

## Содержание

- [Стек технологий](#стек-технологий)
- [Обоснование решения](#обоснование-решения)
- [Данные для работы алгоритма](#данные-для-работы-алгоритма)
- [Литература, используемая при создании проекта](литература,-используемая-при-создании-проекта)

## Стек технологий
- Python 3.8
- Jupyter
- PySpark
- sentence Bert
- sentence_transformers
- sklearn

## Обоснование решения

Использование двух моделей: ALS и bert позволяет системе подбирать рекомендации на основе как контента, так и длительности просмотра видео.

### Анализ доступных данных

- Стандартизация данных (нормализация)
- 
### Анализ моделей рекомендаций

Виды алгоритмов:
- **Collaborative filtering (коллаборативная фильтрация)**
  - **Memory-Based CF (Корреляционные модели)**
    - User-based - При применении данного подтипа рассчитывается значение подобия одного пользователя к другому на основе тех объектов, которые оценили оба пользователя. 
    - Item-based - При использовании данного типа используется мера подобия двух объектов, рассчитывается она на основе оценок объектов от тех пользователей, которые оценили оба сравниваемых объекта.
  - **Latent Models CF (Латентные модели)**
    - Matrix decompositions - матричные разложения
      - Matrix factorization - матричная факторизация
      - Alternating  least squares(ALS) - чередующиеся наименьшие квадраты 
      - Singular Value Decomposition(SVD) - сингулярное разложение
      - Non-Negative Matrix Factorization(NNMF) - неотрицательное матричное разложение
      - Probabilistic latent semantic analysis(PLSA) - вероятностный латентный семантический анализ
      - Implicit feedback - модель с учётом неявных предпочтений
    - Neighborhood methods CF (Методы соседства)
      - k-NN (basic) - (базовый)
      - k-NN (with means) -  (со средствами)
      - k-NN (baseline) - (базовый уровень)
      - Slope one - Первый наклон
      - Co-clustering - Совместная кластеризация
    - Вероятностные модели
    - Deep Learning (глубокое обучение)
      - Content-boosted CF
      - Neural CF
      - DSSM
- **Content-based (основанные на контенте)** - В рамках данного подхода описание объекта (content) сопоставляется с интересами пользователя. Чем больше товар этим интересам соответствует, тем выше оценивается потенциальная заинтересованность пользователя.
- **Knowledge-based (основанные на знаниях)**
  - Case-based - Данный подтип предполагает в качестве дополнительной информации требования пользователя. 
  - Demographic-based - В данном случае в системе учитываются персональные данные о пользователе. Это может быть любая доступная сервису информация, например: пол, возраст, геопозиция и т.д.
  - Utility-based - Рекомендация объектов происходит на основе расчета его полезности для пользователя.
- **Popularity-based** (основанные на популярности) - В данном случае система рекомендует наиболее популярные объекты, не учитывая личные интересы пользователя.
- **Hybrid (Гибридные)** - Гибридные рекомендательные системы одновременно сочетают в себе несколько различных алгоритмов рекомендаций, стараясь получить больше преимуществ каждого из них и нивелировать недостатки.

Проведя анализ доступных алгоритмов мы пришли к выводу: необходимо реализовать гибридную модель, которая за счёт комбинирования разных алгоритмов наиболее эффективно решит поставленную задачу.

**Сравнительная характеристика моделей**

|  | Normal predictor | Baseline (ALS) | SVD-ALS1 | SVD-ALS2 | SVD-SGD | SVD++-SGD | NMF-SGD | k-NN (базовый) | k-NN (со средствами) | SlopeOne | CoClustering |
| ------------- | ------------- | ------------- | ------------- | ------------- | ------------- | ------------- | ------------- | ------------- | ------------- | ------------- | ------------- |
| Скорость | 0.051 | 0.061 | 12.3007 | 13.1128 | 1.0001 | 3.3182 | 1.2431 | 1.0001 | 1.1161 | 0.158 | 1.2651 | 

Возможные недостатки моделей:
- не хватает теоретического обоснования (достаточно эвристичные методы)
- методы требуют хранения большой матрицы в памяти
- холодный старт
- долго обучается на одной машине

Функции близости:
- корреляция Пирсона
- косинусная мера близости
- тест Фишера

- Сгруппировать и проанализировать доступные методы реализации алгоритмов
- Выбрать метод гибридизации из доступных
    Виды гибридизации:
  - Взвешенная: объединение оценок различных компонентов рекомендации в числовом выражении.
  - Переключение: выбор одного из рекомендательных компонентов и применение выбранного.
  - Смешанная: рекомендации от разных рекомендателей представлены вместе, чтобы дать рекомендацию.
  - Комбинация признаков: признаки, полученные из разных источников знаний, объединяются вместе и передаются единому алгоритму рекомендации.
  - Увеличение функции: вычисление функции или набора функций, которые затем являются частью входных данных для следующего метода.
  - Каскад: Рекомендателям предоставляется строгий приоритет, при этом те, кто имеет более низкий приоритет, разрывают связи в оценке тех, кто выше.
  - Метауровень: применяется один метод рекомендации и создается своего рода модель, которая затем является входными данными, используемыми следующим методом.

Исходя из проведенных нами анализов мы выбрали следующее решение:
Гибридная модель на основе bert и ALS.

### Критерии качества и метрики оценки

Критерии качества системы рекомендаций:
- Точность - действительно ли рекомендованные объекты подходят пользователю.
- Покрытие - какая часть объектов из всего множества объектов, может быть рекомендована.
- Скорость - как быстро рекомендательная система способна выдать список из объектов, рекомендованных пользователю.
-	Степень новизны - выданные системой рекомендации должны содержать что-то новое для пользователя.
- Масштабируемость - сохранение точности модели при увеличении данных для анализа.

### Нагрузки и масштабируемость

## Лицензия
Все библиотеки, используемые в проекте, являются OPEN-SOURCE.

## Литература, используемая при создании проекта
- https://your-scorpion.ru/recommendation-systems/
- https://machinelearningmastery.ru/prototyping-a-recommender-system-step-by-step-part-2-alternating-least-square-als-matrix-4a76c58714a1/
- https://devavrat.mit.edu/wp-content/uploads/2017/11/A-Latent-Source-Model-for-Online-Collaborative-Filtering.pdf
- https://spark.apache.org/docs/latest/ml-collaborative-filtering.html
- https://xuwd11.github.io/Recommender_Systems/04_collaborative_filtering.html#co-clustering
- https://github.com/anshbordia/movie-recommender-bert/blob/master/movie_reco.ipynb
- https://arxiv.org/pdf/1707.07435.pdf
- https://arxiv.org/ftp/arxiv/papers/1912/1912.04754.pdf
